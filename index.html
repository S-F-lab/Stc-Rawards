<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STC-REWARDS | Earn Crypto</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Firebase SDK (Legacy Compat Mode) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #10b981;
            --accent: #8b5cf6;
            --dark: #0f172a;
            --darker: #0a0f1f;
            --card-bg: #1e293b;
            --light: #f8fafc;
            --gray: #64748b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #3b82f6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--dark);
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header - Fixed Single Line Navigation */
        header {
            background: rgba(15, 23, 42, 0.98);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(99, 102, 241, 0.2);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            padding: 0;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            height: 60px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 800;
            font-size: 22px;
            color: var(--light);
            text-decoration: none;
            white-space: nowrap;
        }

        .logo i {
            color: var(--primary);
            background: linear-gradient(45deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .main-nav {
            display: flex;
            align-items: center;
            gap: 5px;
            flex: 1;
            justify-content: center;
            margin: 0 20px;
            overflow-x: auto;
            padding: 5px 0;
        }

        .main-nav::-webkit-scrollbar {
            display: none;
        }

        .nav-links {
            display: flex;
            gap: 5px;
            list-style: none;
            white-space: nowrap;
        }

        .nav-links a {
            color: var(--light);
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
            padding: 8px 12px;
            border-radius: 8px;
            transition: all 0.3s;
            border: 1px solid transparent;
        }

        .nav-links a:hover {
            color: var(--primary);
            background: rgba(99, 102, 241, 0.1);
            border-color: rgba(99, 102, 241, 0.3);
        }

        .nav-links a.active {
            background: rgba(99, 102, 241, 0.15);
            color: var(--primary);
            border-color: var(--primary);
        }

        .auth-buttons {
            display: flex;
            gap: 10px;
            white-space: nowrap;
        }

        /* Buttons */
        .btn {
            padding: 10px 18px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            border: none;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--primary), var(--accent));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(99, 102, 241, 0.3);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--light);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #0da271;
        }

        .btn-mining {
            background: linear-gradient(45deg, #f59e0b, #f97316);
            color: white;
            font-weight: 700;
            padding: 12px 24px;
            font-size: 15px;
        }

        /* Hero Section */
        .hero {
            padding: 120px 0 60px;
            background: linear-gradient(135deg, rgba(15, 23, 42, 0.9), rgba(30, 41, 59, 0.9));
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 20% 80%, rgba(99, 102, 241, 0.1) 0%, transparent 50%);
        }

        .hero-content {
            max-width: 700px;
            position: relative;
            z-index: 1;
        }

        .hero h1 {
            font-size: 42px;
            font-weight: 800;
            line-height: 1.2;
            margin-bottom: 20px;
            background: linear-gradient(45deg, var(--light), var(--primary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .hero p {
            font-size: 16px;
            color: #cbd5e1;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .hero-stats {
            display: flex;
            gap: 20px;
            margin-top: 40px;
            flex-wrap: wrap;
        }

        .stat-box {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            min-width: 130px;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .stat-label {
            color: #94a3b8;
            font-size: 13px;
        }

        /* Cards */
        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s;
        }

        .card:hover {
            transform: translateY(-3px);
            border-color: var(--primary);
        }

        .section-title {
            font-size: 32px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 40px;
            color: var(--light);
        }

        /* Features */
        .features {
            padding: 80px 0;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
        }

        .feature-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(45deg, var(--primary), var(--accent));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            font-size: 20px;
        }

        /* Mining Section */
        .mining-section {
            padding: 80px 0;
            background: var(--darker);
        }

        .mining-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            align-items: center;
        }

        .mining-status {
            position: relative;
        }

        .mining-timer {
            font-family: 'Inter', monospace;
            font-size: 56px;
            font-weight: 700;
            color: var(--warning);
            margin: 15px 0;
            text-align: center;
        }

        .progress-container {
            background: rgba(255, 255, 255, 0.1);
            height: 10px;
            border-radius: 5px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(45deg, var(--warning), var(--primary));
            border-radius: 5px;
            width: 0%;
            transition: width 1s linear;
        }

        /* Ads Section */
        .ads-section {
            padding: 80px 0;
        }

        .ads-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .ad-card {
            text-align: center;
            padding: 20px;
        }

        .ad-reward {
            font-size: 20px;
            font-weight: 700;
            color: var(--warning);
            margin: 12px 0;
        }

        /* Dashboard */
        .dashboard {
            padding: 100px 0 60px;
            min-height: 100vh;
        }

        .user-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .user-info h2 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .user-info p {
            color: #94a3b8;
            font-size: 14px;
        }

        .balance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .balance-card {
            padding: 20px;
        }

        .balance-label {
            color: #94a3b8;
            font-size: 13px;
            margin-bottom: 8px;
        }

        .balance-amount {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .balance-value {
            color: var(--success);
            font-weight: 600;
            font-size: 14px;
        }

        /* Referral */
        .referral-section {
            padding: 50px 0;
        }

        .referral-code-box {
            background: linear-gradient(45deg, var(--primary-dark), var(--accent));
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            margin: 25px 0;
        }

        .referral-code {
            font-family: monospace;
            font-size: 24px;
            letter-spacing: 2px;
            background: rgba(0, 0, 0, 0.3);
            padding: 12px;
            border-radius: 8px;
            margin: 12px 0;
            display: inline-block;
        }

        /* Forms */
        .auth-form-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 100px 20px;
        }

        .auth-form {
            width: 100%;
            max-width: 450px;
            background: var(--card-bg);
            border-radius: 16px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .form-title {
            text-align: center;
            font-size: 24px;
            margin-bottom: 25px;
            color: var(--light);
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            margin-bottom: 6px;
            color: #94a3b8;
            font-size: 13px;
            font-weight: 500;
        }

        .form-input {
            width: 100%;
            padding: 12px 14px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--light);
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .divider {
            text-align: center;
            margin: 20px 0;
            position: relative;
            color: #64748b;
            font-size: 13px;
        }

        .divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: rgba(255, 255, 255, 0.1);
        }

        .divider span {
            background: var(--card-bg);
            padding: 0 12px;
            position: relative;
        }

        .btn-google {
            width: 100%;
            background: white;
            color: #333;
            justify-content: center;
        }

        .btn-google:hover {
            background: #f1f1f1;
        }

        /* Modals */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 25px;
            width: 100%;
            max-width: 450px;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: #94a3b8;
            font-size: 20px;
            cursor: pointer;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close-modal:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* Footer */
        footer {
            background: var(--darker);
            padding: 50px 0 25px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .footer-links h4 {
            margin-bottom: 15px;
            color: var(--light);
            font-size: 16px;
        }

        .footer-links ul {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 8px;
        }

        .footer-links a {
            color: #94a3b8;
            text-decoration: none;
            font-size: 13px;
            transition: color 0.3s;
        }

        .footer-links a:hover {
            color: var(--primary);
        }

        .copyright {
            text-align: center;
            padding-top: 25px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #64748b;
            font-size: 12px;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .nav-container {
                flex-wrap: wrap;
                height: auto;
                padding: 10px 0;
            }
            
            .logo {
                order: 1;
            }
            
            .main-nav {
                order: 3;
                flex: 100%;
                margin: 10px 0 0;
                justify-content: flex-start;
            }
            
            .auth-buttons {
                order: 2;
            }
        }

        @media (max-width: 768px) {
            .hero h1 {
                font-size: 32px;
            }
            
            .mining-container {
                grid-template-columns: 1fr;
            }
            
            .mining-timer {
                font-size: 42px;
            }
            
            .user-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .nav-links {
                gap: 3px;
            }
            
            .nav-links a {
                padding: 6px 10px;
                font-size: 13px;
            }
        }

        @media (max-width: 480px) {
            .hero-stats {
                gap: 10px;
            }
            
            .stat-box {
                min-width: 110px;
                padding: 12px;
            }
            
            .stat-value {
                font-size: 22px;
            }
            
            .btn {
                padding: 8px 14px;
                font-size: 13px;
            }
            
            .features-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 80px;
            right: 20px;
            padding: 12px 16px;
            background: var(--success);
            color: white;
            border-radius: 8px;
            z-index: 3000;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            animation: slideIn 0.3s ease-out;
            max-width: 300px;
            font-size: 14px;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .notification.error {
            background: var(--danger);
        }

        .notification.warning {
            background: var(--warning);
        }

        .notification.info {
            background: var(--info);
        }

        /* Page Transitions */
        .page {
            display: none;
        }

        .page.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }

        /* Loading Spinner */
        .spinner {
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Disabled state */
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        /* Active mining indicator */
        .mining-active {
            background: linear-gradient(45deg, #10b981, #059669) !important;
        }

        /* Stats animation */
        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Withdrawal History Table */
        .history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: var(--card-bg);
            border-radius: 10px;
            overflow: hidden;
        }

        .history-table th {
            background: rgba(99, 102, 241, 0.1);
            padding: 15px;
            text-align: left;
            color: var(--primary);
            font-weight: 600;
            font-size: 14px;
        }

        .history-table td {
            padding: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 14px;
        }

        .history-table tr:last-child td {
            border-bottom: none;
        }

        .history-table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            display: inline-block;
        }

        .status-pending {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .status-processing {
            background: rgba(59, 130, 246, 0.2);
            color: var(--info);
        }

        .status-completed {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }

        .status-failed {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        /* Withdrawal History Page */
        .withdrawal-history-page {
            padding: 100px 0 60px;
        }

        .history-filter {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--light);
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .filter-btn.active {
            background: var(--primary);
            border-color: var(--primary);
        }

        .filter-btn:hover {
            background: rgba(99, 102, 241, 0.2);
        }

        .empty-state {
            text-align: center;
            padding: 50px 20px;
            color: #94a3b8;
        }

        .empty-state i {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        /* Firebase User Profile */
        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary);
        }

        .profile-dropdown {
            position: relative;
        }

        .profile-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--card-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 10px 0;
            min-width: 200px;
            display: none;
            z-index: 100;
            margin-top: 10px;
        }

        .profile-dropdown:hover .profile-menu {
            display: block;
        }

        .profile-menu a {
            display: block;
            padding: 10px 20px;
            color: var(--light);
            text-decoration: none;
            font-size: 14px;
        }

        .profile-menu a:hover {
            background: rgba(99, 102, 241, 0.1);
            color: var(--primary);
        }

        /* NEW STYLES FOR MINING PERSISTENCE */
        .mining-persistence-notice {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid var(--warning);
            border-radius: 8px;
            padding: 10px 15px;
            margin-top: 15px;
            font-size: 13px;
            color: var(--warning);
        }
        
        /* NEW STYLES FOR TOKEN PAGE TABS */
        .token-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .token-tab {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: none;
            border-radius: 8px;
            color: #94a3b8;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .token-tab.active {
            background: var(--primary);
            color: white;
        }
        
        .token-tab:hover {
            background: rgba(99, 102, 241, 0.2);
        }
        
        .token-content {
            display: none;
        }
        
        .token-content.active {
            display: block;
        }
        
        .token-details {
            line-height: 1.6;
            color: #cbd5e1;
        }
        
        .token-details h3 {
            margin: 20px 0 10px;
            color: var(--light);
        }
        
        .token-details ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }
        
        .token-details li {
            margin-bottom: 8px;
        }
        
        /* Roadmap timeline */
        .roadmap-timeline {
            position: relative;
            padding-left: 30px;
            border-left: 2px solid var(--primary);
        }
        
        .roadmap-phase {
            margin-bottom: 30px;
            position: relative;
        }
        
        .roadmap-phase::before {
            content: '';
            position: absolute;
            left: -38px;
            top: 0;
            width: 30px;
            height: 30px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .roadmap-phase.completed::before {
            background: var(--success);
            content: '✓';
            color: white;
            font-size: 12px;
        }
        
        .roadmap-phase.current::before {
            background: var(--primary);
            content: '●';
            color: white;
            font-size: 20px;
        }
        
        .roadmap-phase.future::before {
            background: var(--accent);
            content: '☆';
            color: white;
        }
    </style>
</head>
<body>
    <!-- Header with Single Line Navigation -->
    <header>
        <div class="container nav-container">
            <a href="#" class="logo" onclick="showPage('home')">
                <i class="fas fa-gem"></i>
                STC-REWARDS
            </a>
            
            <div class="main-nav">
                <ul class="nav-links">
                    <li><a href="#" onclick="showPage('home')" class="active">Home</a></li>
                    <li><a href="#" onclick="showPage('dashboard')" id="dashboardLink">Dashboard</a></li>
                    <li><a href="#" onclick="showPage('mining')">Mining</a></li>
                    <li><a href="#" onclick="showPage('ads')">Watch Ads</a></li>
                    <li><a href="#" onclick="showPage('referral')">Referral</a></li>
                    <li><a href="#" onclick="showPage('withdrawalHistory')">Withdrawal History</a></li>
                    <li><a href="#" onclick="showPage('token')">STC Token</a></li>
                </ul>
            </div>
            
            <div class="auth-buttons">
                <button class="btn btn-primary" onclick="showAuthModal('login')" id="loginBtn">Login</button>
                <button class="btn btn-secondary" onclick="showAuthModal('signup')" id="signupBtn">Sign Up</button>
                <div class="profile-dropdown" id="userProfile" style="display: none;">
                    <div style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <img src="" alt="Profile" class="user-avatar" id="userAvatar">
                        <span id="userNameDisplay"></span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="profile-menu">
                        <a href="#" onclick="showPage('dashboard')"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
                        <a href="#" onclick="showPage('withdrawalHistory')"><i class="fas fa-history"></i> Withdrawal History</a>
                        <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Home Page -->
    <div id="home" class="page active">
        <section class="hero">
            <div class="container">
                <div class="hero-content">
                    <h1>Earn STC Tokens & Crypto Rewards</h1>
                    <p>Watch ads, mine STC tokens, refer friends and convert your earnings to USDT. Join thousands earning passive income daily.</p>
                    <button class="btn btn-mining pulse" onclick="startMiningFromHome()">
                        <i class="fas fa-play"></i> Start Mining STC
                    </button>
                    
                    <div class="hero-stats">
                        <div class="stat-box">
                            <div class="stat-value" id="totalUsers">25,847</div>
                            <div class="stat-label">Active Users</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value">$1.00</div>
                            <div class="stat-label">STC Token Price</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value" id="totalWithdrawn">$384,920</div>
                            <div class="stat-label">Total Withdrawn</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value" id="activeMiners">8,452</div>
                            <div class="stat-label">Active Miners</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="features">
            <div class="container">
                <h2 class="section-title">How It Works</h2>
                <div class="features-grid">
                    <div class="card">
                        <div class="feature-icon">
                            <i class="fas fa-user-plus"></i>
                        </div>
                        <h3>Create Account</h3>
                        <p>Sign up with Google or email and start earning. Get 20 STC bonus only with referral code.</p>
                    </div>
                    <div class="card">
                        <div class="feature-icon">
                            <i class="fas fa-ad"></i>
                        </div>
                        <h3>Watch Ads</h3>
                        <p>Watch short video ads and earn 10-20 random coins. 1000 coins = $1 USDT. Minimum $2 withdrawal.</p>
                    </div>
                    <div class="card">
                        <div class="feature-icon">
                            <i class="fas fa-hard-hat"></i>
                        </div>
                        <h3>Mine STC Tokens</h3>
                        <p>Mine STC tokens in 6-hour sessions. Earn 12 STC per session. STC price is locked at $1.</p>
                    </div>
                    <div class="card">
                        <div class="feature-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <h3>Refer Friends</h3>
                        <p>Earn 20 STC tokens for each successful referral. Your friend also gets 20 STC bonus with your code.</p>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Dashboard Page -->
    <div id="dashboard" class="page">
        <section class="dashboard">
            <div class="container">
                <div class="user-header">
                    <div class="user-info">
                        <h2 id="userName">Welcome to Dashboard</h2>
                        <p id="userEmail"></p>
                    </div>
                    <div>
                        <button class="btn btn-secondary" onclick="showPage('withdrawalHistory')">
                            <i class="fas fa-history"></i> Withdrawal History
                        </button>
                    </div>
                </div>

                <div class="balance-grid">
                    <div class="card balance-card">
                        <div class="balance-label">STC Tokens</div>
                        <div class="balance-amount" id="stcBalance">0</div>
                        <div class="balance-value">$<span id="stcValue">0</span></div>
                    </div>
                    <div class="card balance-card">
                        <div class="balance-label">Coins Balance</div>
                        <div class="balance-amount" id="coinBalance">0</div>
                        <div class="balance-value">≈ $<span id="coinValue">0</span> USDT</div>
                    </div>
                    <div class="card balance-card">
                        <div class="balance-label">USDT Balance</div>
                        <div class="balance-amount" id="usdtBalance">0.00</div>
                        <div class="balance-value">Available for withdrawal</div>
                    </div>
                </div>

                <div style="margin: 30px 0;">
                    <h3 style="margin-bottom: 15px;">Quick Actions</h3>
                    <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                        <button class="btn btn-primary" onclick="showPage('mining')">
                            <i class="fas fa-play"></i> Start Mining
                        </button>
                        <button class="btn btn-success" onclick="showPage('ads')">
                            <i class="fas fa-ad"></i> Watch Ads
                        </button>
                        <button class="btn btn-mining" onclick="showPage('referral')">
                            <i class="fas fa-user-plus"></i> Refer Friends
                        </button>
                        <button class="btn btn-secondary" onclick="showWithdrawModal()">
                            <i class="fas fa-wallet"></i> Withdraw Funds
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Mining Page -->
    <div id="mining" class="page">
        <section class="mining-section">
            <div class="container">
                <h2 class="section-title">STC Token Mining</h2>
                <div class="mining-container">
                    <div class="card mining-status">
                        <h3 style="margin-bottom: 15px;">Mining Status: <span id="miningStatusText" style="color: var(--success);">Ready to Start</span></h3>
                        <div class="mining-timer" id="miningTimer">06:00:00</div>
                        <div class="progress-container">
                            <div class="progress-bar" id="miningProgress"></div>
                        </div>
                        <div style="text-align: center;">
                            <p style="margin-bottom: 15px; color: #94a3b8;">Each mining session: 6 hours → 12 STC tokens</p>
                            <button class="btn btn-mining" id="miningBtn" onclick="toggleMining()">Start Mining</button>
                        </div>
                    </div>
                    <div class="card">
                        <h3 style="margin-bottom: 15px;">Mining Details</h3>
                        <div style="margin-bottom: 15px;">
                            <h4>STC Token Price: $1.00</h4>
                            <p style="color: #94a3b8; margin-top: 5px; font-size: 13px;">Fixed price per token</p>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <h4>Mining Rewards</h4>
                            <p style="color: #94a3b8; margin-top: 5px; font-size: 13px;">12 STC per 6-hour session</p>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <h4>Withdrawal Status</h4>
                            <p style="color: #94a3b8; margin-top: 5px; font-size: 13px;">Locked - Unlocking Soon</p>
                        </div>
                        <div>
                            <h4>Total Mined</h4>
                            <p style="font-size: 22px; color: var(--success); margin-top: 5px;" id="totalMined">0 STC</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Ads Page -->
    <div id="ads" class="page">
        <section class="ads-section">
            <div class="container">
                <h2 class="section-title">Watch Ads & Earn Coins</h2>
                <p style="text-align: center; margin-bottom: 30px; color: #94a3b8;">Watch ads and earn 10-20 random coins. 1000 coins = $1 USDT.</p>
                
                <div class="ads-grid">
                    <div class="card ad-card">
                        <i class="fas fa-gamepad fa-2x" style="color: var(--primary);"></i>
                        <h4 style="margin: 12px 0; font-size: 16px;">Game Ad</h4>
                        <div class="ad-reward">10-20 coins</div>
                        <button class="btn btn-primary watch-ad-btn" data-min="10" data-max="20">
                            <i class="fas fa-play"></i> Watch (30s)
                        </button>
                    </div>
                    <div class="card ad-card">
                        <i class="fas fa-shopping-bag fa-2x" style="color: var(--accent);"></i>
                        <h4 style="margin: 12px 0; font-size: 16px;">Shopping Ad</h4>
                        <div class="ad-reward">12-18 coins</div>
                        <button class="btn btn-primary watch-ad-btn" data-min="12" data-max="18">
                            <i class="fas fa-play"></i> Watch (25s)
                        </button>
                    </div>
                    <div class="card ad-card">
                        <i class="fas fa-film fa-2x" style="color: var(--warning);"></i>
                        <h4 style="margin: 12px 0; font-size: 16px;">Video Ad</h4>
                        <div class="ad-reward">15-20 coins</div>
                        <button class="btn btn-primary watch-ad-btn" data-min="15" data-max="20">
                            <i class="fas fa-play"></i> Watch (45s)
                        </button>
                    </div>
                    <div class="card ad-card">
                        <i class="fas fa-mobile-alt fa-2x" style="color: var(--success);"></i>
                        <h4 style="margin: 12px 0; font-size: 16px;">App Ad</h4>
                        <div class="ad-reward">10-15 coins</div>
                        <button class="btn btn-primary watch-ad-btn" data-min="10" data-max="15">
                            <i class="fas fa-play"></i> Watch (20s)
                        </button>
                    </div>
                </div>

                <div class="card" style="margin-top: 30px; text-align: center;">
                    <h3 style="margin-bottom: 12px; font-size: 18px;">Your Earnings</h3>
                    <p style="font-size: 22px; color: var(--warning); margin-bottom: 12px;" id="totalCoins">0 coins</p>
                    <p style="color: #94a3b8; margin-bottom: 15px; font-size: 13px;">1000 coins = $1 USDT | Minimum withdrawal: $2 (2000 coins)</p>
                    <div style="display: flex; gap: 12px; justify-content: center; flex-wrap: wrap;">
                        <button class="btn btn-success" onclick="convertCoins()">
                            <i class="fas fa-exchange-alt"></i> Convert to USDT
                        </button>
                        <button class="btn btn-primary" onclick="showWithdrawModal()">
                            <i class="fas fa-wallet"></i> Withdraw Funds
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Referral Page -->
    <div id="referral" class="page">
        <section class="referral-section">
            <div class="container">
                <h2 class="section-title">Referral Program</h2>
                <div class="card" style="text-align: center; margin-bottom: 30px;">
                    <h3 style="margin-bottom: 12px;">Earn 20 STC Per Referral!</h3>
                    <p style="color: #94a3b8; margin-bottom: 15px; font-size: 14px;">Share your referral code and earn 20 STC tokens for each friend who signs up with your code.</p>
                </div>

                <div class="referral-code-box">
                    <h4 style="margin-bottom: 12px;">Your Referral Code</h4>
                    <div class="referral-code" id="referralCodeDisplay">STC-<span id="refCode">X8Y9Z7</span></div>
                    <p style="margin: 15px 0; font-size: 14px;">Share this code with your friends</p>
                    <button class="btn btn-mining" onclick="copyReferralCode()">
                        <i class="fas fa-copy"></i> Copy Referral Code
                    </button>
                </div>

                <div class="card" style="margin-top: 30px;">
                    <h3 style="margin-bottom: 15px;">Referral Statistics</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px;">
                        <div>
                            <h4 style="font-size: 14px;">Total Referrals</h4>
                            <p style="font-size: 28px; color: var(--primary);" id="refCount">0</p>
                        </div>
                        <div>
                            <h4 style="font-size: 14px;">STC Earned</h4>
                            <p style="font-size: 28px; color: var(--success);" id="refEarnings">0</p>
                        </div>
                        <div>
                            <h4 style="font-size: 14px;">Referral Bonus</h4>
                            <p style="font-size: 28px; color: var(--warning);">20 STC</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Withdrawal History Page -->
    <div id="withdrawalHistory" class="page">
        <section class="withdrawal-history-page">
            <div class="container">
                <h2 class="section-title">Withdrawal History</h2>
                
                <div class="history-filter">
                    <button class="filter-btn active" onclick="filterWithdrawals('all')">All</button>
                    <button class="filter-btn" onclick="filterWithdrawals('pending')">Pending</button>
                    <button class="filter-btn" onclick="filterWithdrawals('processing')">Processing</button>
                    <button class="filter-btn" onclick="filterWithdrawals('completed')">Completed</button>
                    <button class="filter-btn" onclick="filterWithdrawals('failed')">Failed</button>
                </div>

                <div class="card">
                    <div id="withdrawalHistoryContent">
                        <!-- History will be loaded here -->
                        <div class="empty-state" id="emptyHistory">
                            <i class="fas fa-history"></i>
                            <h3>No Withdrawal History</h3>
                            <p>You haven't made any withdrawals yet.</p>
                            <button class="btn btn-primary" onclick="showWithdrawModal()" style="margin-top: 15px;">
                                <i class="fas fa-wallet"></i> Make Your First Withdrawal
                            </button>
                        </div>
                        
                        <table class="history-table" id="withdrawalHistoryTable" style="display: none;">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Amount (USDT)</th>
                                    <th>Wallet Address</th>
                                    <th>Network</th>
                                    <th>Status</th>
                                    <th>Transaction ID</th>
                                </tr>
                            </thead>
                            <tbody id="withdrawalHistoryBody">
                                <!-- Rows will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Token Page - UPDATED WITH TABS -->
    <div id="token" class="page">
        <section class="mining-section">
            <div class="container">
                <h2 class="section-title">STC Token Information</h2>
                
                <div class="token-tabs">
                    <button class="token-tab active" onclick="showTokenTab('overview')">Overview</button>
                    <button class="token-tab" onclick="showTokenTab('whitepaper')">White Paper</button>
                    <button class="token-tab" onclick="showTokenTab('roadmap')">Road Map</button>
                    <button class="token-tab" onclick="showTokenTab('tokenomics')">Tokenomics</button>
                </div>
                
                <!-- Overview Tab -->
                <div id="overviewTab" class="token-content active">
                    <div class="card" style="margin-bottom: 25px;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px;">
                            <div>
                                <h3 style="margin-bottom: 12px;">STC Token Price</h3>
                                <p style="font-size: 42px; color: var(--success); font-weight: 700;">$1.00</p>
                                <p style="color: #94a3b8; font-size: 13px;">Fixed price per token</p>
                            </div>
                            <div>
                                <h3 style="margin-bottom: 12px;">Market Cap</h3>
                                <p style="font-size: 28px; color: var(--primary); font-weight: 700;">$12.45M</p>
                                <p style="color: #94a3b8; font-size: 13px;">Total circulating supply</p>
                            </div>
                            <div>
                                <h3 style="margin-bottom: 12px;">Total Supply</h3>
                                <p style="font-size: 28px; color: var(--accent); font-weight: 700;">100M STC</p>
                                <p style="color: #94a3b8; font-size: 13px;">Maximum token supply</p>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <h3 style="margin-bottom: 15px;">About STC Token</h3>
                        <div class="token-details">
                            <p>STC (Stable Token Coin) is a utility token designed specifically for the STC-REWARDS ecosystem. Each STC token is pegged to $1 USD, providing stable value for users.</p>
                            
                            <h3>Key Features:</h3>
                            <ul>
                                <li><strong>Stable Value:</strong> Each STC token maintains a fixed value of $1 USD</li>
                                <li><strong>Utility:</strong> Used for platform rewards, mining, and referral bonuses</li>
                                <li><strong>Earnable:</strong> Users can earn STC through various activities on the platform</li>
                                <li><strong>Convertible:</strong> STC can be converted to USDT at 1:1 ratio</li>
                                <li><strong>Limited Supply:</strong> Total supply capped at 100 million tokens</li>
                            </ul>
                            
                            <h3>Use Cases:</h3>
                            <ul>
                                <li>Platform rewards for watching ads</li>
                                <li>Mining rewards for participating in mining sessions</li>
                                <li>Referral bonuses for inviting new users</li>
                                <li>Future platform features and upgrades</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- White Paper Tab -->
                <div id="whitepaperTab" class="token-content">
                    <div class="card">
                        <div class="token-details">
                            <h2 style="margin-bottom: 20px;">STC Token White Paper</h2>
                            
                            <h3>1. Executive Summary</h3>
                            <p>STC Token is a utility token designed to power the STC-REWARDS ecosystem. This white paper outlines the technical implementation, economic model, and future development roadmap of the STC token.</p>
                            
                            <h3>2. Introduction</h3>
                            <p>STC-REWARDS platform enables users to earn cryptocurrency through various activities including watching ads, mining simulations, and referral programs. The STC token serves as the primary reward mechanism within this ecosystem.</p>
                            
                            <h3>3. Technical Architecture</h3>
                            <ul>
                                <li><strong>Token Standard:</strong> Utility Token (Non-blockchain based for demonstration)</li>
                                <li><strong>Value Peg:</strong> 1 STC = $1 USD</li>
                                <li><strong>Storage:</strong> Secure cloud storage with Firebase</li>
                                <li><strong>Transactions:</strong> Real-time balance updates</li>
                            </ul>
                            
                            <h3>4. Economic Model</h3>
                            <ul>
                                <li><strong>Total Supply:</strong> 100,000,000 STC</li>
                                <li><strong>Circulating Supply:</strong> Algorithmically controlled based on user activity</li>
                                <li><strong>Inflation Control:</strong> Fixed mining rates and daily limits</li>
                                <li><strong>Value Stability:</strong> Pegged to USD through reserve mechanisms</li>
                            </ul>
                            
                            <h3>5. Security Features</h3>
                            <ul>
                                <li>Google Firebase Authentication</li>
                                <li>Secure data encryption</li>
                                <li>Withdrawal verification system</li>
                                <li>Anti-fraud monitoring</li>
                            </ul>
                            
                            <h3>6. Future Development</h3>
                            <p>The STC token ecosystem will evolve with platform enhancements, additional earning methods, and integration with external services.</p>
                            
                            <div style="text-align: center; margin-top: 30px;">
                                <button class="btn btn-primary" onclick="downloadWhitepaper()">
                                    <i class="fas fa-download"></i> Download White Paper (PDF)
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Road Map Tab -->
                <div id="roadmapTab" class="token-content">
                    <div class="card">
                        <div class="token-details">
                            <h2 style="margin-bottom: 20px;">STC Token Road Map</h2>
                            
                            <div class="roadmap-timeline">
                                <!-- Phase 1 -->
                                <div class="roadmap-phase completed">
                                    <h3 style="color: var(--success);">Phase 1: Platform Launch (Q4 2023)</h3>
                                    <ul>
                                        <li>✓ Platform development and testing</li>
                                        <li>✓ STC token implementation</li>
                                        <li>✓ Basic mining functionality</li>
                                        <li>✓ Ad watching rewards system</li>
                                        <li>✓ Referral program setup</li>
                                    </ul>
                                </div>
                                
                                <!-- Phase 2 -->
                                <div class="roadmap-phase current">
                                    <h3>Phase 2: Mobile App & Features (Q1 2024)</h3>
                                    <ul>
                                        <li>iOS and Android mobile app release</li>
                                        <li>Enhanced mining algorithms</li>
                                        <li>Additional ad formats and partners</li>
                                        <li>User profile customization</li>
                                        <li>Advanced analytics dashboard</li>
                                    </ul>
                                </div>
                                
                                <!-- Phase 3 -->
                                <div class="roadmap-phase future">
                                    <h3>Phase 3: Exchange Integration (Q2 2024)</h3>
                                    <ul>
                                        <li>STC token exchange listing</li>
                                        <li>Cross-platform transfer capabilities</li>
                                        <li>Wallet integration</li>
                                        <li>Multi-chain support</li>
                                        <li>Partnership announcements</li>
                                    </ul>
                                </div>
                                
                                <!-- Phase 4 -->
                                <div class="roadmap-phase future">
                                    <h3>Phase 4: Ecosystem Expansion (Q3 2024)</h3>
                                    <ul>
                                        <li>STC wallet application</li>
                                        <li>Merchant adoption program</li>
                                        <li>Staking and governance features</li>
                                        <li>Advanced DeFi integrations</li>
                                        <li>Community governance implementation</li>
                                    </ul>
                                </div>
                                
                                <!-- Future -->
                                <div class="roadmap-phase future">
                                    <h3 style="color: var(--accent);">Future Vision (2025+)</h3>
                                    <ul>
                                        <li>Global expansion to new markets</li>
                                        <li>NFT marketplace integration</li>
                                        <li>Advanced AI-powered earning opportunities</li>
                                        <li>Complete decentralized platform transition</li>
                                        <li>Industry partnerships and collaborations</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Tokenomics Tab -->
                <div id="tokenomicsTab" class="token-content">
                    <div class="card">
                        <div class="token-details">
                            <h2 style="margin-bottom: 20px;">STC Token Tokenomics</h2>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; margin-bottom: 30px;">
                                <div>
                                    <h3>Distribution Breakdown</h3>
                                    <ul>
                                        <li><strong>Mining Rewards:</strong> 40,000,000 STC (40%)</li>
                                        <li><strong>Platform Reserve:</strong> 30,000,000 STC (30%)</li>
                                        <li><strong>Team & Development:</strong> 15,000,000 STC (15%)</li>
                                        <li><strong>Marketing & Partnerships:</strong> 10,000,000 STC (10%)</li>
                                        <li><strong>Community & Airdrops:</strong> 5,000,000 STC (5%)</li>
                                    </ul>
                                </div>
                                <div>
                                    <h3>Release Schedule</h3>
                                    <ul>
                                        <li><strong>Mining Rewards:</strong> Linear release over 4 years</li>
                                        <li><strong>Platform Reserve:</strong> Locked for 1 year, then quarterly release</li>
                                        <li><strong>Team Allocation:</strong> 2-year vesting with 6-month cliff</li>
                                        <li><strong>Marketing Funds:</strong> As needed based on roadmap</li>
                                        <li><strong>Community Funds:</strong> Immediate availability for programs</li>
                                    </ul>
                                </div>
                            </div>
                            
                            <div style="background: rgba(99, 102, 241, 0.1); padding: 20px; border-radius: 10px; margin-top: 20px;">
                                <h3 style="margin-bottom: 10px;">Key Economic Principles</h3>
                                <ul>
                                    <li><strong>Value Stability:</strong> Each STC token maintains $1 peg through reserve mechanisms</li>
                                    <li><strong>Sustainable Growth:</strong> Controlled emission rates prevent inflation</li>
                                    <li><strong>Utility-First:</strong> Token designed for platform utility rather than speculation</li>
                                    <li><strong>Transparent Distribution:</strong> All allocations publicly documented</li>
                                    <li><strong>Community Focus:</strong> Majority of tokens allocated to user rewards</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('loginModal')">&times;</button>
            <h2 class="form-title">Login to STC-REWARDS</h2>
            
            <button class="btn btn-google" onclick="googleAuth()" id="googleLoginBtn">
                <i class="fab fa-google"></i> Continue with Google
            </button>
            
            <div class="divider">
                <span>or continue with email</span>
            </div>
            
            <form id="loginForm" onsubmit="handleEmailLogin(event)">
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="loginEmail" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Password (9 characters)</label>
                    <input type="password" class="form-input" id="loginPassword" minlength="9" maxlength="9" required>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;" id="loginSubmitBtn">
                    Login
                </button>
            </form>
            
            <p style="text-align: center; margin-top: 15px; color: #94a3b8; font-size: 13px;">
                Don't have an account? <a href="#" onclick="switchToSignup()" style="color: var(--primary);">Sign up</a>
            </p>
        </div>
    </div>

    <!-- Signup Modal -->
    <div id="signupModal" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('signupModal')">&times;</button>
            <h2 class="form-title">Create Account</h2>
            
            <button class="btn btn-google" onclick="googleAuth()" id="googleSignupBtn">
                <i class="fab fa-google"></i> Sign up with Google
            </button>
            
            <div class="divider">
                <span>or sign up with email</span>
            </div>
            
            <form id="signupForm" onsubmit="handleEmailSignup(event)">
                <div class="form-group">
                    <label class="form-label">Full Name</label>
                    <input type="text" class="form-input" id="signupName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Date of Birth</label>
                    <input type="date" class="form-input" id="signupDob" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="signupEmail" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Password (9 characters)</label>
                    <input type="password" class="form-input" id="signupPassword" minlength="9" maxlength="9" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Referral Code (Optional)</label>
                    <input type="text" class="form-input" id="signupReferral" placeholder="Enter code to get 20 STC bonus">
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;" id="signupSubmitBtn">
                    Create Account
                </button>
            </form>
            
            <p style="text-align: center; margin-top: 15px; color: #94a3b8; font-size: 13px;">
                Already have an account? <a href="#" onclick="switchToLogin()" style="color: var(--primary);">Login</a>
            </p>
        </div>
    </div>

    <!-- Withdraw Modal -->
    <div id="withdrawModal" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('withdrawModal')">&times;</button>
            <h2 class="form-title">Withdraw USDT</h2>
            
            <div class="form-group">
                <label class="form-label">Amount to Withdraw (USDT)</label>
                <input type="number" class="form-input" id="withdrawAmount" min="2" step="0.1" value="2">
                <p style="font-size: 12px; color: #94a3b8; margin-top: 5px;">Minimum: $2 USDT (2000 coins)</p>
            </div>
            
            <div class="form-group">
                <label class="form-label">USDT Wallet Address (TRC20)</label>
                <input type="text" class="form-input" id="walletAddress" placeholder="Enter your TRC20 wallet address">
            </div>
            
            <div class="form-group">
                <label class="form-label">Network</label>
                <select class="form-input" id="withdrawNetwork">
                    <option value="TRC20">TRC20 (Recommended)</option>
                    <option value="ERC20">ERC20</option>
                    <option value="BEP20">BEP20</option>
                </select>
            </div>
            
            <button class="btn btn-success" onclick="processWithdrawal()" style="width: 100%;" id="withdrawSubmitBtn">
                <i class="fas fa-check"></i> Confirm Withdrawal
            </button>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div>
                    <div class="logo" style="margin-bottom: 15px; font-size: 20px;">
                        <i class="fas fa-gem"></i>
                        STC-REWARDS
                    </div>
                    <p style="color: #94a3b8; max-width: 280px; font-size: 13px;">Earn cryptocurrency through ads, mining, and referrals. Join the future of rewards today.</p>
                </div>
                <div class="footer-links">
                    <h4>Platform</h4>
                    <ul>
                        <li><a href="#" onclick="showPage('home')">Home</a></li>
                        <li><a href="#" onclick="showPage('mining')">Mining</a></li>
                        <li><a href="#" onclick="showPage('ads')">Watch Ads</a></li>
                        <li><a href="#" onclick="showPage('referral')">Referral</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href="#" onclick="showPage('token'); setTimeout(() => showTokenTab('whitepaper'), 100);">White Paper</a></li>
                        <li><a href="#" onclick="showPage('token'); setTimeout(() => showTokenTab('roadmap'), 100);">Road Map</a></li>
                        <li><a href="#" onclick="showAuthModal('login')">Login</a></li>
                        <li><a href="#" onclick="showAuthModal('signup')">Sign Up</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h4>Legal</h4>
                    <ul>
                        <li><a href="javascript:void(0)" onclick="showLegalModal('terms')">Terms of Service</a></li>
                        <li><a href="javascript:void(0)" onclick="showLegalModal('privacy')">Privacy Policy</a></li>
                        <li><a href="javascript:void(0)" onclick="showLegalModal('cookies')">Cookie Policy</a></li>
                        <li><a href="javascript:void(0)" onclick="showLegalModal('disclaimer')">Disclaimer</a></li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2023 STC-REWARDS. All rights reserved.</p>
                <p style="margin-top: 5px; font-size: 11px;">This is a demonstration platform. STC Token is a utility token within the STC-REWARDS ecosystem.</p>
            </div>
        </div>
    </footer>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDn4uLD3qNuEYpiXf_S8q_PVGzeaTlRthc",
            authDomain: "stc-rewards-b541f.firebaseapp.com",
            projectId: "stc-rewards-b541f",
            storageBucket: "stc-rewards-b541f.firebasestorage.app",
            messagingSenderId: "886121063816",
            appId: "1:886121063816:web:bb2ad55b5e05db7163c63d"
        };

        // Initialize Firebase
        let auth = null;
        try {
            firebase.initializeApp(firebaseConfig);
            auth = firebase.auth();
            console.log("Firebase initialized successfully");
        } catch (error) {
            console.log("Firebase initialization error:", error);
        }

        // User data structure - UPDATED FOR PERSISTENT MINING
        let user = {
            uid: null,
            loggedIn: false,
            name: "",
            email: "",
            photoURL: "",
            stc: 0,
            coins: 0,
            usdt: 0,
            referrals: 0,
            totalMined: 0,
            mining: false,
            miningStartTime: null,
            miningEndTime: null,
            joinDate: "",
            referralCode: "",
            withdrawalHistory: []
        };

        // DOM elements
        let currentModal = null;
        let isProcessing = false;
        let activeNav = 'home';
        let activeFilter = 'all';
        let miningCheckInterval = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initializeFirebaseAuth();
            setupEventListeners();
            updateUI();
            
            // Update stats periodically
            setInterval(updateStats, 5000);
            
            // Set current date as max for date input
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('signupDob').max = today;
            
            // Check for active mining session on load
            checkAndRestoreMining();
            
            // Start periodic mining check
            startMiningChecker();
        });

        // Start periodic mining checker
        function startMiningChecker() {
            if (miningCheckInterval) {
                clearInterval(miningCheckInterval);
            }
            
            miningCheckInterval = setInterval(() => {
                if (user.loggedIn && user.mining && user.miningEndTime) {
                    const now = Date.now();
                    if (now >= user.miningEndTime) {
                        completeMiningSession();
                    } else {
                        updateMiningTimer();
                    }
                }
            }, 1000); // Check every second
        }

        // Enhanced mining restoration
        function checkAndRestoreMining() {
            if (!user.loggedIn) return;
            
            // Check if there's an active mining session
            if (user.mining && user.miningEndTime) {
                const now = Date.now();
                
                if (now >= user.miningEndTime) {
                    // Mining completed while away
                    completeMiningSession();
                } else {
                    // Resume mining
                    resumeMiningSession();
                }
            }
        }

        // Resume mining session
        function resumeMiningSession() {
            if (!user.mining || !user.miningEndTime) return;
            
            const now = Date.now();
            const remainingTime = Math.max(0, user.miningEndTime - now);
            
            // Update UI if on mining page
            if (activeNav === 'mining') {
                updateMiningUI(remainingTime);
                
                const miningBtn = document.getElementById('miningBtn');
                const miningStatus = document.getElementById('miningStatusText');
                if (miningBtn && miningStatus) {
                    miningBtn.textContent = 'Stop Mining';
                    miningBtn.classList.remove('btn-mining');
                    miningBtn.classList.add('mining-active');
                    miningStatus.textContent = 'Mining in progress...';
                    miningStatus.style.color = '#10b981';
                }
            }
            
            // Add persistence notice
            showMiningPersistenceNotice();
            
            console.log("Mining session resumed with", Math.floor(remainingTime / 1000), "seconds remaining");
        }

        // Complete mining session
        function completeMiningSession() {
            if (!user.mining) return;
            
            user.mining = false;
            user.miningStartTime = null;
            user.miningEndTime = null;
            user.stc += 12;
            user.totalMined += 12;
            
            // Save user data
            saveUserData();
            
            // Update UI
            updateUI();
            
            // Update mining page if active
            if (activeNav === 'mining') {
                const miningBtn = document.getElementById('miningBtn');
                const miningStatus = document.getElementById('miningStatusText');
                if (miningBtn && miningStatus) {
                    miningBtn.textContent = 'Start Mining';
                    miningBtn.classList.remove('mining-active');
                    miningBtn.classList.add('btn-mining');
                    miningStatus.textContent = 'Mining completed! Ready to start again.';
                    miningStatus.style.color = '';
                    
                    document.getElementById('miningTimer').textContent = '06:00:00';
                    document.getElementById('miningProgress').style.width = '0%';
                }
            }
            
            // Show notification
            showNotification('Mining completed! You earned 12 STC tokens.');
            
            // Remove persistence notice
            removeMiningPersistenceNotice();
        }

        // Show mining persistence notice
        function showMiningPersistenceNotice() {
            removeMiningPersistenceNotice();
            
            if (activeNav === 'mining') {
                const notice = document.createElement('div');
                notice.className = 'mining-persistence-notice';
                notice.id = 'miningPersistenceNotice';
                notice.innerHTML = `
                    <i class="fas fa-info-circle"></i>
                    Your mining session will continue even if you close this page or navigate away.
                    Progress is saved automatically.
                `;
                
                const miningStatus = document.querySelector('.mining-status');
                if (miningStatus) {
                    miningStatus.appendChild(notice);
                }
            }
        }

        // Remove mining persistence notice
        function removeMiningPersistenceNotice() {
            const existingNotice = document.getElementById('miningPersistenceNotice');
            if (existingNotice) {
                existingNotice.remove();
            }
        }

        // Update mining timer display
        function updateMiningTimer() {
            if (!user.mining || !user.miningEndTime) return;
            
            const now = Date.now();
            const remainingTime = Math.max(0, user.miningEndTime - now);
            
            updateMiningUI(remainingTime);
            
            // Auto-save progress every 30 seconds
            if (Math.floor(remainingTime / 1000) % 30 === 0) {
                saveUserData();
            }
        }

        // Update mining UI
        function updateMiningUI(remainingTime) {
            if (activeNav !== 'mining') return;
            
            const hours = Math.floor(remainingTime / 3600000);
            const minutes = Math.floor((remainingTime % 3600000) / 60000);
            const seconds = Math.floor((remainingTime % 60000) / 1000);
            
            const timerElement = document.getElementById('miningTimer');
            if (timerElement) {
                timerElement.textContent = 
                    `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            
            const progress = ((21600000 - remainingTime) / 21600000) * 100;
            const progressBar = document.getElementById('miningProgress');
            if (progressBar) {
                progressBar.style.width = `${progress}%`;
            }
        }

        // Show token tab
        function showTokenTab(tabName) {
            // Update active tab button
            document.querySelectorAll('.token-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Hide all tab contents
            document.querySelectorAll('.token-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(`${tabName}Tab`).classList.add('active');
        }

        // Download whitepaper function
        function downloadWhitepaper() {
            showNotification('White Paper download started...', 'info');
            
            // Simulate download
            setTimeout(() => {
                showNotification('White Paper downloaded successfully!', 'success');
            }, 2000);
        }

        // Toggle mining function
        function toggleMining() {
            if (!user.loggedIn) {
                showAuthModal('login');
                return;
            }
            
            const miningBtn = document.getElementById('miningBtn');
            const miningStatus = document.getElementById('miningStatusText');
            
            if (!user.mining) {
                // Start mining
                startMining();
                miningBtn.textContent = 'Stop Mining';
                miningBtn.classList.remove('btn-mining');
                miningBtn.classList.add('mining-active');
                miningStatus.textContent = 'Mining in progress...';
                miningStatus.style.color = '#10b981';
                showNotification('Mining started! Session will complete in 6 hours.');
                showMiningPersistenceNotice();
            } else {
                // Stop mining
                stopMining();
                miningBtn.textContent = 'Start Mining';
                miningBtn.classList.remove('mining-active');
                miningBtn.classList.add('btn-mining');
                miningStatus.textContent = 'Ready to Start';
                miningStatus.style.color = '';
                showNotification('Mining stopped');
                removeMiningPersistenceNotice();
            }
            
            saveUserData();
        }

        // Start mining function
        function startMining() {
            user.mining = true;
            user.miningStartTime = Date.now();
            user.miningEndTime = Date.now() + (6 * 60 * 60 * 1000); // 6 hours from now
            
            // Update UI immediately
            updateMiningUI(user.miningEndTime - Date.now());
        }

        // Stop mining function
        function stopMining() {
            user.mining = false;
            user.miningStartTime = null;
            user.miningEndTime = null;
            
            // Reset UI if on mining page
            if (activeNav === 'mining') {
                document.getElementById('miningTimer').textContent = '06:00:00';
                document.getElementById('miningProgress').style.width = '0%';
            }
        }

        // Initialize Firebase Authentication
        function initializeFirebaseAuth() {
            if (!auth) {
                console.log("Firebase auth not initialized");
                return;
            }

            // Listen for auth state changes
            auth.onAuthStateChanged((firebaseUser) => {
                if (firebaseUser) {
                    // User is signed in
                    handleFirebaseUser(firebaseUser);
                } else {
                    // User is signed out
                    handleLogout();
                }
            });
        }

        // Handle Firebase user
        function handleFirebaseUser(firebaseUser) {
            user.uid = firebaseUser.uid;
            user.loggedIn = true;
            user.name = firebaseUser.displayName || firebaseUser.email.split('@')[0];
            user.email = firebaseUser.email;
            user.photoURL = firebaseUser.photoURL || "https://ui-avatars.com/api/?name=" + encodeURIComponent(user.name) + "&background=6366f1&color=fff";
            user.joinDate = new Date().toLocaleDateString();
            
            // Load user data from localStorage
            loadUserData();
            
            // If new user (no data saved), initialize with default values
            if (!user.referralCode) {
                user.referralCode = generateReferralCode();
                // Only give STC if user came from referral
                const urlParams = new URLSearchParams(window.location.search);
                const refCode = urlParams.get('ref') || localStorage.getItem('referral_code');
                if (refCode) {
                    user.stc += 20;
                    user.referrals++;
                    localStorage.removeItem('referral_code');
                    showNotification('Welcome! You received 20 STC bonus from referral.');
                }
            }
            
            saveUserData();
            updateUI();
            closeAllModals();
            showPage('dashboard');
            
            // Update UI with Firebase user info
            document.getElementById('userAvatar').src = user.photoURL;
            document.getElementById('userNameDisplay').textContent = user.name;
            
            showNotification('Welcome back, ' + user.name + '!');
            
            // Check for mining session
            checkAndRestoreMining();
        }

        // Setup event listeners
        function setupEventListeners() {
            // Watch ad buttons
            document.querySelectorAll('.watch-ad-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    watchAd(this);
                });
            });
            
            // Form submissions
            document.getElementById('loginForm')?.addEventListener('submit', handleEmailLogin);
            document.getElementById('signupForm')?.addEventListener('submit', handleEmailSignup);
            
            // Close modals on ESC
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && currentModal) {
                    closeModal(currentModal);
                }
            });
            
            // Close modals on outside click
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('modal')) {
                    closeAllModals();
                }
            });
            
            // Save mining state before page unload
            window.addEventListener('beforeunload', function() {
                if (user.mining) {
                    saveUserData();
                }
            });
        }

        // Generate random referral code
        function generateReferralCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let code = '';
            for (let i = 0; i < 6; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return code;
        }

        // Page navigation
        function showPage(pageId) {
            if (pageId === 'dashboard' && !user.loggedIn) {
                showNotification('Please login to access dashboard', 'warning');
                showAuthModal('login');
                return;
            }
            
            if (pageId === 'withdrawalHistory' && !user.loggedIn) {
                showNotification('Please login to view withdrawal history', 'warning');
                showAuthModal('login');
                return;
            }
            
            // Update active nav
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.classList.remove('active');
            });
            
            const activeLink = document.querySelector(`.nav-links a[onclick*="${pageId}"]`);
            if (activeLink) {
                activeLink.classList.add('active');
            }
            
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show selected page
            document.getElementById(pageId).classList.add('active');
            activeNav = pageId;
            
            // Load withdrawal history if on that page
            if (pageId === 'withdrawalHistory') {
                loadWithdrawalHistory();
            }
            
            // Update header buttons
            updateHeaderButtons();
            
            // Show/hide mining persistence notice
            if (pageId === 'mining' && user.mining) {
                showMiningPersistenceNotice();
                updateMiningTimer();
            } else {
                removeMiningPersistenceNotice();
            }
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Update header buttons based on login state
        function updateHeaderButtons() {
            const loginBtn = document.getElementById('loginBtn');
            const signupBtn = document.getElementById('signupBtn');
            const userProfile = document.getElementById('userProfile');
            
            if (user.loggedIn) {
                loginBtn.style.display = 'none';
                signupBtn.style.display = 'none';
                userProfile.style.display = 'flex';
            } else {
                loginBtn.style.display = 'inline-flex';
                signupBtn.style.display = 'inline-flex';
                userProfile.style.display = 'none';
            }
        }

        // Modal handling
        function showAuthModal(type) {
            closeAllModals();
            currentModal = type === 'login' ? 'loginModal' : 'signupModal';
            document.getElementById(currentModal).classList.add('active');
        }

        function closeModal(modalId) {
            if (!modalId) return;
            document.getElementById(modalId).classList.remove('active');
            currentModal = null;
            resetFormButtons();
        }

        function closeAllModals() {
            document.querySelectorAll('.modal').forEach(modal => {
                modal.classList.remove('active');
            });
            currentModal = null;
            resetFormButtons();
        }

        function switchToSignup() {
            closeModal('loginModal');
            showAuthModal('signup');
        }

        function switchToLogin() {
            closeModal('signupModal');
            showAuthModal('login');
        }

        // Show notification
        function showNotification(message, type = 'success') {
            // Remove existing notification
            const existing = document.querySelector('.notification');
            if (existing) existing.remove();
            
            // Create notification
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            // Auto remove after 3 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 3000);
        }

        // Set button loading state
        function setButtonLoading(buttonId, isLoading) {
            const button = document.getElementById(buttonId);
            if (!button) return;
            
            if (isLoading) {
                button.disabled = true;
                button.innerHTML = '<div class="spinner"></div>';
            } else {
                button.disabled = false;
                if (buttonId === 'loginSubmitBtn') {
                    button.innerHTML = 'Login';
                } else if (buttonId === 'signupSubmitBtn') {
                    button.innerHTML = 'Create Account';
                } else if (buttonId === 'withdrawSubmitBtn') {
                    button.innerHTML = '<i class="fas fa-check"></i> Confirm Withdrawal';
                } else if (buttonId === 'googleLoginBtn' || buttonId === 'googleSignupBtn') {
                    button.innerHTML = '<i class="fab fa-google"></i> ' + (buttonId === 'googleLoginBtn' ? 'Continue with Google' : 'Sign up with Google');
                }
            }
        }

        // Reset all form buttons
        function resetFormButtons() {
            setButtonLoading('loginSubmitBtn', false);
            setButtonLoading('signupSubmitBtn', false);
            setButtonLoading('withdrawSubmitBtn', false);
            setButtonLoading('googleLoginBtn', false);
            setButtonLoading('googleSignupBtn', false);
            isProcessing = false;
        }

        // Google authentication with Firebase
        async function googleAuth() {
            if (!auth) {
                showNotification('Authentication service is not available. Please refresh the page.', 'error');
                return;
            }
            
            if (isProcessing) return;
            isProcessing = true;
            
            const isSignup = currentModal === 'signupModal';
            setButtonLoading(isSignup ? 'googleSignupBtn' : 'googleLoginBtn', true);
            
            try {
                const provider = new firebase.auth.GoogleAuthProvider();
                // Add scopes
                provider.addScope('profile');
                provider.addScope('email');
                
                // Sign in with popup
                await auth.signInWithPopup(provider);
                // User is automatically handled by onAuthStateChanged
            } catch (error) {
                console.error("Google Auth Error:", error);
                showNotification('Failed to sign in with Google: ' + error.message, 'error');
                isProcessing = false;
                setButtonLoading(isSignup ? 'googleSignupBtn' : 'googleLoginBtn', false);
            }
        }

        // Email/Password login
        async function handleEmailLogin(event) {
            event.preventDefault();
            if (!auth) {
                showNotification('Authentication service is not available. Please refresh the page.', 'error');
                return;
            }
            
            if (isProcessing) return;
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (password.length !== 9) {
                showNotification('Password must be exactly 9 characters', 'error');
                return;
            }
            
            isProcessing = true;
            setButtonLoading('loginSubmitBtn', true);
            
            try {
                await auth.signInWithEmailAndPassword(email, password);
                // User is automatically handled by onAuthStateChanged
            } catch (error) {
                console.error("Email Login Error:", error);
                showNotification('Login failed: ' + error.message, 'error');
                isProcessing = false;
                setButtonLoading('loginSubmitBtn', false);
            }
        }

        // Email/Password signup
        async function handleEmailSignup(event) {
            event.preventDefault();
            if (!auth) {
                showNotification('Authentication service is not available. Please refresh the page.', 'error');
                return;
            }
            
            if (isProcessing) return;
            
            const name = document.getElementById('signupName').value;
            const dob = document.getElementById('signupDob').value;
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            const referral = document.getElementById('signupReferral').value.trim();
            
            if (password.length !== 9) {
                showNotification('Password must be exactly 9 characters', 'error');
                return;
            }
            
            // Check if user is at least 18 years old
            const birthDate = new Date(dob);
            const age = new Date().getFullYear() - birthDate.getFullYear();
            if (age < 18) {
                showNotification('You must be at least 18 years old to register', 'error');
                return;
            }
            
            isProcessing = true;
            setButtonLoading('signupSubmitBtn', true);
            
            try {
                // Save referral code for later use
                if (referral) {
                    localStorage.setItem('referral_code', referral);
                }
                
                // Create user with email/password
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                
                // Update profile with name
                await userCredential.user.updateProfile({
                    displayName: name
                });
                
                // User is automatically handled by onAuthStateChanged
            } catch (error) {
                console.error("Email Signup Error:", error);
                showNotification('Signup failed: ' + error.message, 'error');
                isProcessing = false;
                setButtonLoading('signupSubmitBtn', false);
            }
        }

        // Start mining from home button
        function startMiningFromHome() {
            if (!user.loggedIn) {
                showAuthModal('login');
                return;
            }
            showPage('mining');
            setTimeout(() => {
                if (!user.mining) {
                    document.getElementById('miningBtn').click();
                }
            }, 300);
        }

        // Watch ad
        function watchAd(button) {
            if (!user.loggedIn) {
                showAuthModal('login');
                return;
            }
            
            if (button.disabled) return;
            
            const min = parseInt(button.getAttribute('data-min'));
            const max = parseInt(button.getAttribute('data-max'));
            const coins = Math.floor(Math.random() * (max - min + 1)) + min;
            
            // Disable button during ad
            button.disabled = true;
            const originalText = button.innerHTML;
            button.innerHTML = '<div class="spinner"></div>';
            
            // Simulate ad watching with progress
            let timeLeft = 30;
            const interval = setInterval(() => {
                timeLeft--;
                button.innerHTML = `<div class="spinner"></div> ${timeLeft}s`;
                
                if (timeLeft <= 0) {
                    clearInterval(interval);
                    
                    user.coins += coins;
                    saveUserData();
                    updateUI();
                    
                    button.disabled = false;
                    button.innerHTML = originalText;
                    
                    showNotification(`You earned ${coins} coins!`);
                }
            }, 1000);
        }

        // Convert coins to USDT (1000 coins = $1)
        function convertCoins() {
            if (!user.loggedIn) {
                showAuthModal('login');
                return;
            }
            
            if (user.coins < 1000) {
                showNotification('Minimum 1000 coins required for conversion', 'error');
                return;
            }
            
            const usdt = user.coins / 1000;
            user.usdt += usdt;
            const convertedCoins = user.coins;
            user.coins = 0;
            saveUserData();
            updateUI();
            showNotification(`Converted ${convertedCoins} coins to ${usdt.toFixed(2)} USDT!`);
        }

        // Withdrawal
        function showWithdrawModal() {
            if (!user.loggedIn) {
                showAuthModal('login');
                return;
            }
            
            if (user.usdt < 2) {
                showNotification('Minimum $2 USDT required for withdrawal', 'error');
                return;
            }
            
            document.getElementById('withdrawAmount').value = Math.max(2, user.usdt).toFixed(2);
            currentModal = 'withdrawModal';
            document.getElementById('withdrawModal').classList.add('active');
        }

        // Process withdrawal
        async function processWithdrawal() {
            if (isProcessing) return;
            
            const amount = parseFloat(document.getElementById('withdrawAmount').value);
            const wallet = document.getElementById('walletAddress').value.trim();
            const network = document.getElementById('withdrawNetwork').value;
            
            if (amount < 2) {
                showNotification('Minimum withdrawal is $2', 'error');
                return;
            }
            
            if (amount > user.usdt) {
                showNotification('Insufficient USDT balance', 'error');
                return;
            }
            
            if (!wallet) {
                showNotification('Please enter wallet address', 'error');
                return;
            }
            
            isProcessing = true;
            setButtonLoading('withdrawSubmitBtn', true);
            
            try {
                // Simulate API call
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // Create withdrawal record
                const withdrawal = {
                    id: 'WD' + Date.now() + Math.floor(Math.random() * 1000),
                    date: new Date().toLocaleDateString('en-US', {
                        year: 'numeric',
                        month: 'short',
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    }),
                    amount: amount,
                    wallet: wallet.substring(0, 8) + '...' + wallet.substring(wallet.length - 8),
                    network: network,
                    status: 'pending',
                    transactionId: null
                };
                
                // Update user balance
                user.usdt -= amount;
                
                // Add to withdrawal history
                if (!user.withdrawalHistory) {
                    user.withdrawalHistory = [];
                }
                user.withdrawalHistory.unshift(withdrawal);
                
                // Save data
                saveUserData();
                updateUI();
                
                // Close modal and show success
                closeModal('withdrawModal');
                showNotification(`Withdrawal request of $${amount} submitted! Status: Pending`);
                
                // Clear form
                document.getElementById('walletAddress').value = '';
                
                // Simulate status updates over time
                simulateWithdrawalProcessing(withdrawal);
                
            } catch (error) {
                showNotification('Withdrawal failed: ' + error.message, 'error');
            } finally {
                isProcessing = false;
                setButtonLoading('withdrawSubmitBtn', false);
            }
        }

        // Simulate withdrawal processing
        function simulateWithdrawalProcessing(withdrawal) {
            // Update to processing after 30 seconds
            setTimeout(() => {
                withdrawal.status = 'processing';
                saveUserData();
                if (activeNav === 'withdrawalHistory') {
                    loadWithdrawalHistory();
                }
                showNotification(`Withdrawal ${withdrawal.id} is now processing`, 'info');
            }, 30000);
            
            // Randomly complete or fail after 2-5 minutes
            const completionTime = 120000 + Math.random() * 180000; // 2-5 minutes
            setTimeout(() => {
                const successRate = 0.9; // 90% success rate
                if (Math.random() < successRate) {
                    withdrawal.status = 'completed';
                    withdrawal.transactionId = 'TX' + Date.now() + Math.floor(Math.random() * 10000);
                    showNotification(`Withdrawal ${withdrawal.id} completed! Transaction ID: ${withdrawal.transactionId}`, 'success');
                } else {
                    withdrawal.status = 'failed';
                    user.usdt += withdrawal.amount; // Refund on failure
                    showNotification(`Withdrawal ${withdrawal.id} failed. Funds have been returned to your account.`, 'error');
                }
                saveUserData();
                updateUI();
                if (activeNav === 'withdrawalHistory') {
                    loadWithdrawalHistory();
                }
            }, completionTime);
        }

        // Load withdrawal history
        function loadWithdrawalHistory() {
            const historyBody = document.getElementById('withdrawalHistoryBody');
            const historyTable = document.getElementById('withdrawalHistoryTable');
            const emptyHistory = document.getElementById('emptyHistory');
            
            if (!user.withdrawalHistory || user.withdrawalHistory.length === 0) {
                historyTable.style.display = 'none';
                emptyHistory.style.display = 'block';
                return;
            }
            
            // Filter withdrawals based on active filter
            let filteredHistory = user.withdrawalHistory;
            if (activeFilter !== 'all') {
                filteredHistory = user.withdrawalHistory.filter(w => w.status === activeFilter);
            }
            
            if (filteredHistory.length === 0) {
                historyTable.style.display = 'none';
                emptyHistory.innerHTML = `
                    <i class="fas fa-filter"></i>
                    <h3>No ${activeFilter} withdrawals</h3>
                    <p>You don't have any ${activeFilter} withdrawals.</p>
                `;
                emptyHistory.style.display = 'block';
                return;
            }
            
            // Clear table
            historyBody.innerHTML = '';
            historyTable.style.display = 'table';
            emptyHistory.style.display = 'none';
            
            // Add rows
            filteredHistory.forEach(withdrawal => {
                const row = document.createElement('tr');
                
                // Status badge
                let statusBadge = '';
                switch (withdrawal.status) {
                    case 'pending':
                        statusBadge = '<span class="status-badge status-pending">Pending</span>';
                        break;
                    case 'processing':
                        statusBadge = '<span class="status-badge status-processing">Processing</span>';
                        break;
                    case 'completed':
                        statusBadge = '<span class="status-badge status-completed">Completed</span>';
                        break;
                    case 'failed':
                        statusBadge = '<span class="status-badge status-failed">Failed</span>';
                        break;
                }
                
                row.innerHTML = `
                    <td>${withdrawal.date}</td>
                    <td>$${withdrawal.amount.toFixed(2)}</td>
                    <td>${withdrawal.wallet}</td>
                    <td>${withdrawal.network}</td>
                    <td>${statusBadge}</td>
                    <td>${withdrawal.transactionId || '--'}</td>
                `;
                
                historyBody.appendChild(row);
            });
        }

        // Filter withdrawals
        function filterWithdrawals(status) {
            activeFilter = status;
            
            // Update filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Reload history with filter
            loadWithdrawalHistory();
        }

        // Copy referral code
        function copyReferralCode() {
            const fullCode = `STC-${user.referralCode}`;
            
            navigator.clipboard.writeText(fullCode).then(() => {
                showNotification('Referral code copied to clipboard! Share it with friends.');
            }).catch(err => {
                // Fallback for browsers that don't support clipboard API
                const tempInput = document.createElement('input');
                tempInput.value = fullCode;
                document.body.appendChild(tempInput);
                tempInput.select();
                document.execCommand('copy');
                document.body.removeChild(tempInput);
                showNotification('Referral code copied to clipboard!');
            });
        }

        // Update UI
        function updateUI() {
            // Update referral code display
            document.getElementById('refCode').textContent = user.referralCode || 'X8Y9Z7';
            
            // Update balances
            document.getElementById('stcBalance').textContent = user.stc;
            document.getElementById('stcValue').textContent = user.stc;
            document.getElementById('coinBalance').textContent = user.coins;
            document.getElementById('coinValue').textContent = (user.coins / 1000).toFixed(2);
            document.getElementById('usdtBalance').textContent = user.usdt.toFixed(2);
            document.getElementById('totalCoins').textContent = user.coins + ' coins';
            document.getElementById('totalMined').textContent = user.totalMined + ' STC';
            document.getElementById('refCount').textContent = user.referrals;
            document.getElementById('refEarnings').textContent = (user.referrals * 20) + ' STC';
            
            // Update user name and email
            if (user.loggedIn) {
                document.getElementById('userName').textContent = `Welcome, ${user.name}!`;
                document.getElementById('userEmail').textContent = user.email;
                
                // Update profile dropdown
                document.getElementById('userNameDisplay').textContent = user.name;
                if (user.photoURL) {
                    document.getElementById('userAvatar').src = user.photoURL;
                }
            }
            
            // Update header buttons
            updateHeaderButtons();
        }

        // Update live stats
        function updateStats() {
            if (Math.random() > 0.7) {
                const users = parseInt(document.getElementById('totalUsers').textContent.replace(/,/g, ''));
                document.getElementById('totalUsers').textContent = (users + Math.floor(Math.random() * 3)).toLocaleString();
            }
            
            if (Math.random() > 0.8) {
                const withdrawn = parseFloat(document.getElementById('totalWithdrawn').textContent.replace(/[$,]/g, ''));
                const increase = Math.floor(Math.random() * 50) + 10;
                document.getElementById('totalWithdrawn').textContent = '$' + (withdrawn + increase).toLocaleString();
            }
            
            if (Math.random() > 0.75) {
                const miners = parseInt(document.getElementById('activeMiners').textContent.replace(/,/g, ''));
                const change = Math.floor(Math.random() * 20) - 10;
                const newMiners = Math.max(0, miners + change);
                document.getElementById('activeMiners').textContent = newMiners.toLocaleString();
            }
        }

        // Save/Load user data - UPDATED FOR PERSISTENT MINING
        function saveUserData() {
            if (user.uid) {
                localStorage.setItem(`stc_user_${user.uid}`, JSON.stringify(user));
            }
        }

        function loadUserData() {
            if (user.uid) {
                const saved = localStorage.getItem(`stc_user_${user.uid}`);
                if (saved) {
                    try {
                        const savedData = JSON.parse(saved);
                        // Merge saved data with current user object
                        Object.assign(user, savedData);
                    } catch (e) {
                        console.log('Error loading user data');
                    }
                }
            }
        }

        // Logout - UPDATED
        async function logout() {
            if (!auth) {
                showNotification('Authentication service is not available.', 'error');
                return;
            }
            
            try {
                // Stop mining
                if (user.mining) {
                    stopMining();
                }
                
                // Clear mining check interval
                if (miningCheckInterval) {
                    clearInterval(miningCheckInterval);
                }
                
                // Sign out from Firebase
                await auth.signOut();
                
                // Reset user data
                user = {
                    uid: null,
                    loggedIn: false,
                    name: "",
                    email: "",
                    photoURL: "",
                    stc: 0,
                    coins: 0,
                    usdt: 0,
                    referrals: 0,
                    totalMined: 0,
                    mining: false,
                    miningStartTime: null,
                    miningEndTime: null,
                    joinDate: "",
                    referralCode: "",
                    withdrawalHistory: []
                };
                
                updateUI();
                showPage('home');
                showNotification('Logged out successfully');
            } catch (error) {
                console.error("Logout Error:", error);
                showNotification('Logout failed: ' + error.message, 'error');
            }
        }

        // Handle logout from Firebase
        function handleLogout() {
            // Stop mining
            if (user.mining) {
                stopMining();
            }
            
            // Clear mining check interval
            if (miningCheckInterval) {
                clearInterval(miningCheckInterval);
            }
            
            // Reset user data
            user = {
                uid: null,
                loggedIn: false,
                name: "",
                email: "",
                photoURL: "",
                stc: 0,
                coins: 0,
                usdt: 0,
                referrals: 0,
                totalMined: 0,
                mining: false,
                miningStartTime: null,
                miningEndTime: null,
                joinDate: "",
                referralCode: "",
                withdrawalHistory: []
            };
            
            updateUI();
            if (activeNav !== 'home') {
                showPage('home');
            }
        }

        // Show legal modal
        function showLegalModal(type) {
            let title = '';
            let content = '';
            
            switch(type) {
                case 'terms':
                    title = 'Terms of Service';
                    content = `
                        <h3>STC-REWARDS Terms of Service</h3>
                        <p><strong>Last Updated:</strong> ${new Date().toLocaleDateString()}</p>
                        
                        <h4>1. Acceptance of Terms</h4>
                        <p>Welcome to STC-REWARDS. By accessing or using our platform, you agree to be bound by these Terms of Service.</p>
                        
                        <h4>2. Platform Description</h4>
                        <p>STC-REWARDS is a demonstration platform that allows users to earn virtual STC tokens through various activities including watching ads, mining simulations, and referral programs.</p>
                    `;
                    break;
                case 'privacy':
                    title = 'Privacy Policy';
                    content = `
                        <h3>Privacy Policy</h3>
                        <p><strong>Last Updated:</strong> ${new Date().toLocaleDateString()}</p>
                        
                        <h4>1. Information We Collect</h4>
                        <p>We collect information you provide directly, including your name, email address, and date of birth during registration.</p>
                    `;
                    break;
                case 'cookies':
                    title = 'Cookie Policy';
                    content = `
                        <h3>Cookie Policy</h3>
                        <p><strong>Last Updated:</strong> ${new Date().toLocaleDateString()}</p>
                        
                        <h4>1. What Are Cookies</h4>
                        <p>Cookies are small text files stored on your device when you visit websites. Our platform uses browser localStorage which functions similarly to cookies.</p>
                    `;
                    break;
                case 'disclaimer':
                    title = 'Disclaimer';
                    content = `
                        <h3>Disclaimer</h3>
                        <p><strong>Last Updated:</strong> ${new Date().toLocaleDateString()}</p>
                        
                        <h4>1. Demonstration Platform</h4>
                        <p>STC-REWARDS is a demonstration and educational platform only. It simulates cryptocurrency mining and rewards for learning purposes.</p>
                    `;
                    break;
            }
            
            // Create modal if it doesn't exist
            if (!document.getElementById('legalModal')) {
                const modalHTML = `
                    <div id="legalModal" class="modal">
                        <div class="modal-content" style="max-width: 700px; max-height: 80vh; overflow-y: auto;">
                            <button class="close-modal" onclick="closeModal('legalModal')">&times;</button>
                            <h2 class="form-title">${title}</h2>
                            <div id="legalModalContent" style="color: #cbd5e1; line-height: 1.6; font-size: 14px; margin-top: 15px;">
                                ${content}
                            </div>
                            <div style="text-align: center; margin-top: 20px;">
                                <button class="btn btn-primary" onclick="closeModal('legalModal')">Close</button>
                            </div>
                        </div>
                    </div>
                `;
                document.body.insertAdjacentHTML('beforeend', modalHTML);
            } else {
                document.getElementById('legalModalContent').innerHTML = content;
                document.querySelector('#legalModal .form-title').textContent = title;
            }
            
            document.getElementById('legalModal').classList.add('active');
            currentModal = 'legalModal';
        }

        // Set up referral URL sharing
        function setupReferralSharing() {
            const urlParams = new URLSearchParams(window.location.search);
            const refCode = urlParams.get('ref');
            if (refCode && !user.loggedIn) {
                localStorage.setItem('referral_code', refCode);
                showNotification('Referral code detected! Sign up to get 20 STC bonus.', 'info');
            }
        }

        // Initialize referral sharing
        setupReferralSharing();
    </script>
</body>
</html>